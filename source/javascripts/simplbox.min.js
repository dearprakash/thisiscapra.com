/***
* SimplBox - v1.0.0 - 2014.08.04
* Author: (c) Dendrochronology - @Dendrochronolo - http://genert.laal.ee/
* Available for use under the MIT License.
***/
!function(e,t){"use strict";function n(e,t){var r=this;r.m_Elements=e,r.m_UserOptions=t||{},r.m_Options={},r.m_CurrentTargetElements=i,r.m_CurrentTargetElementsLength=i,r.m_CurrentTargetNumber=i,r.m_CurrentImageElement=i,r.m_InProgress=i,r.m_InstalledImageBox=i,r.m_Alt=i,r.m_AnimateDone=i;!function(){for(var e in n.options)r.m_Options[e]=r.m_UserOptions.hasOwnProperty(e)?r.m_UserOptions[e]:n.options[e]}()}var r=t.documentElement,a=t.getElementsByTagName("body")[0],i=!1,m="attachEvent",o="addEventListener",s=o in t;n.prototype={init:function(){var e=this;e.API_AddEvent=e.addEvent,e.API_RemoveImageElement=e.removeImageElement,e.checkBrowser(),e.addEvents()},checkBrowser:function(){var t=this,n="ontouchstart"in e||e.navigator.msMaxTouchPoints||navigator.maxTouchPoints||i,r=n&&(e.navigator.pointerEnabled||e.navigator.msPointerEnabled);t.browser={isHardwareAccelerated:"undefined"!==t.getcss3prop("transition")?!0:i,isTouch:n,hasPointers:r}},addEvents:function(){for(var n=this,r=0;r<n.m_Elements.length;r++)!function(t){n.addEvent(n.m_Elements[t],n.browser.hasPointers?"pointerup MSPointerUp":"click",function(r){console.log(n.m_Elements[t]),r.preventDefault&&(r.preventDefault(),r.stopPropagation()),e.event&&(e.event.returnValue=i,e.event.cancelBubble=i),n.isFunction(n.m_Options.onStart())&&n.m_Options.onStart(this),n.m_CurrentTargetElements=n.m_Elements,n.m_CurrentTargetElementsLength=n.m_Elements.length,n.m_CurrentTargetNumber=t,n.openImage(n.m_Elements[n.m_CurrentTargetNumber])})}(r);if(n.addEvent(e,"resize",function(){n.calculateImagePositionAndSize(n.m_CurrentImageElement,!0)}),n.leftAnimationFunction=function(){n.m_CurrentTargetNumber-1<0?(n.openImage(n.m_CurrentTargetElements[n.m_CurrentTargetElementsLength-1],"left"),n.m_CurrentTargetNumber=n.m_CurrentTargetElementsLength-1):(n.openImage(n.m_CurrentTargetElements[n.m_CurrentTargetNumber-1],"left"),n.m_CurrentTargetNumber=n.m_CurrentTargetNumber-1)},n.rightAnimationFunction=function(){n.m_CurrentTargetNumber+1>n.m_CurrentTargetElementsLength-1?(n.openImage(n.m_CurrentTargetElements[0],"right"),n.m_CurrentTargetNumber=0):(n.openImage(n.m_CurrentTargetElements[n.m_CurrentTargetNumber+1],"right"),n.m_CurrentTargetNumber=n.m_CurrentTargetNumber+1)},n.m_Options.enableKeyboard){var m={left:37,right:39,esc:27};n.addEvent(e,"keydown",function(t){if(n.m_CurrentImageElement&&!n.m_InProgress){if(t.preventDefault&&(t.preventDefault(),t.stopPropagation()),e.event){var t=e.event;e.event.returnValue=i,e.event.cancelBubble=i}var r=t.which||t.keyCode;switch(r){case m.esc:return n.removeImageElement(),i;case m.right:return n.rightAnimationFunction(),i;case m.left:return n.leftAnimationFunction(),i}}})}n.m_Options.quitOnDocumentClick&&n.addEvent(s?a:t,"click",function(t){if(n.m_InProgress)return i;if(e.event)var t=e.event;var r=t.target?t.target:t.srcElement;return r&&r.id!==n.m_Options.imageElementId&&n.m_InstalledImageBox&&!n.m_InProgress?(n.removeImageElement(),i):void 0})},openImage:function(n,r){var m=this,o=t.createDocumentFragment(),s=t.createElement("img"),l=t.getElementById(m.m_Options.imageElementId);if(n&&"a"===n.tagName.toLowerCase()){if(l&&(a.removeChild(l),m.m_CurrentImageElement=i,m.m_InstalledImageBox=i),m.m_Alt=n.firstChild.getAttribute("alt"),m.m_InProgress=!0,m.isFunction(m.m_Options.onImageLoadStart())&&m.m_Options.onImageLoadStart(),"undefined"!=typeof r)switch(r){case"left":r=-1;break;case"right":r=1}if(s.setAttribute("id",m.m_Options.imageElementId),s.setAttribute("src",n.getAttribute("href")),s.setAttribute("alt",m.m_Alt),s.setAttribute("style","position: fixed; cursor: pointer; opacity: 0;"),o.appendChild(s),a.appendChild(o),m.m_CurrentImageElement=t.getElementById(m.m_Options.imageElementId),m.m_CurrentImageElement.style.filter="alpha(opacity=0)",m.browser.isHardwareAccelerated&&("undefined"!=typeof r&&(m.m_CurrentImageElement.style[m.getcss3prop("transform")]="translateX("+r*m.m_Options.fadeInDistance+"px)"),m.m_CurrentImageElement.style[m.getcss3prop("transition")]="all "+m.m_Options.animationSpeed+"ms ease"),m.calculateImagePositionAndSize(m.m_CurrentImageElement,i,r),m.m_Options.quitOnImageClick&&m.addEvent(m.m_CurrentImageElement,"click",function(t){t.preventDefault&&t.preventDefault(),e.event&&(e.event.returnValue=i),m.removeImageElement()}),m.browser.isTouch){var u=-1,g=-1,c=0;m.addEvent(m.m_CurrentImageElement,"touchstart pointerdown MSPointerDown",function(e){e.preventDefault(),u=e.pageX||e.touches[0].pageX}),m.addEvent(m.m_CurrentImageElement,"touchmove pointermove MSPointerMove",function(e){e.preventDefault(),g=e.pageX||e.touches[0].pageX,c=u-g,m.browser.isHardwareAccelerated&&(m.m_CurrentImageElement.style[m.getcss3prop("transition")]="none",m.m_CurrentImageElement.style[m.getcss3prop("transform")]="translateX("+-c+"px)")}),m.addEvent(m.m_CurrentImageElement,"touchend pointerup pointercancel MSPointerUp MSPointerCancel",function(e){e.preventDefault(),Math.abs(c)>75?0>c?m.leftAnimationFunction():m.rightAnimationFunction():m.m_CurrentImageElement.style[m.getcss3prop("transform")]="translateX(0px)"})}}},calculateImagePositionAndSize:function(t,n){var a=this,m=new Image,o=0,s=0,l=0;t&&(a.m_ImageSource=t.getAttribute("src"),a.m_ScreenHeight=e.innerHeight||r.offsetHeight,a.m_ScreenWidth=e.innerWidth||r.offsetWidth,m.onload=function(){var e=this.width,r=this.height;o=e,s=r,l=o/s,Math.floor(a.m_ScreenWidth/l)>a.m_ScreenHeight?(o=a.m_ScreenHeight*l*a.m_Options.imageSize,s=a.m_ScreenHeight*a.m_Options.imageSize):(o=a.m_ScreenWidth*a.m_Options.imageSize,s=a.m_ScreenWidth/l*a.m_Options.imageSize),o>e&&(o=e),s>r&&(s=r),t.style.top=(a.m_ScreenHeight-s)/2+"px",t.style.left=(a.m_ScreenWidth-o)/2+"px",t.style.width=Math.floor(o)+"px",t.style.height=Math.floor(s)+"px",n||setTimeout(function(){if(a.browser.isHardwareAccelerated)t.style.opacity=1,t.style[a.getcss3prop("transform")]="translateX(0px)";else{var e=1;a.animate({delay:16,duration:a.m_Options.animationSpeed,delta:a.linear,step:function(n){t.style.opacity=e*n,t.style.filter="alpha(opacity="+e*n*100+")"}})}a.m_InProgress=i,a.m_InstalledImageBox=!0,a.isFunction(a.m_Options.onImageLoadEnd())&&a.m_Options.onImageLoadEnd(t)},100)},m.src=a.m_ImageSource)},removeImageElement:function(){var e=this;if(e.m_CurrentImageElement){if(e.isFunction(e.m_Options.onEnd())&&e.m_Options.onEnd(),e.m_InProgress&&e.isFunction(e.m_Options.onImageLoadEnd())&&e.m_Options.onImageLoadEnd(p_Element),e.browser.isHardwareAccelerated)e.m_CurrentImageElement.style.opacity=0,e.m_CurrentImageElement.style.transition="opacity 250ms ease";else{var t=0;e.animate({delay:16,duration:250,delta:e.linear,step:function(n){e.m_CurrentImageElement.style.opacity=t*n,e.m_CurrentImageElement.style.filter="alpha(opacity="+t*n*100+")"}})}setTimeout(function(){e.m_CurrentImageElement&&e.m_CurrentImageElement.parentNode.removeChild(e.m_CurrentImageElement),e.m_CurrentImageElement=i,e.m_InstalledImageBox=i},e.browser.isHardwareAccelerated?250:350)}},isFunction:function(e){return!!(e&&e.constructor&&e.call&&e.apply)},addEvent:function(n,r,a){var l,u;if(r=r.split(" "),s)if((!n||n instanceof Array&&!n.length||0===n.length)&&n!==e){if(n&&"undefined"!==n[0])for(l=0;l<n.length;l++)for(u=0;u<r.length;u++)n[l][o](r[u],a,i)}else for(l=0;l<r.length;l++)n[o](r[l],a,i);else for(l=0;l<r.length;l++)if(-1!==r[l].indexOf("keydown"))t[m]("on"+r[l],a);else if((!n||n instanceof Array&&!n.length||0===n.length)&&n!==e){if(n&&"undefined"!==n[0])for(u=0;u<n.length;u++)n[u][m](r[l],a)}else n[m]("on"+r[l],a)},animate:function(e){var t=this,n=new Date,r=setInterval(function(){var a=new Date-n,i=a/e.duration;i>1&&(i=1);var m=e.delta(i);e.step(m),1==i&&(t.m_AnimateDone=!0,clearInterval(r))},e.delay||10)},linear:function(e){return e},getcss3prop:function(e){for(var t=["","-moz-","-webkit-","-o-","-ms-","-khtml-"],n=function(e){return e.replace(/\-([a-z])/gi,function(e,t){return t.toUpperCase()})},a=0;a<t.length;a++){var i=n(t[a]+e);if("Ms"==i.substr(0,2)&&(i="m"+i.substr(1)),i in r.style)return i}return"undefined"}},n.options={imageElementId:"simplbox",fadeInDistance:100,animationSpeed:350,imageSize:.8,quitOnImageClick:!0,quitOnDocumentClick:!0,enableKeyboard:!0,onImageLoadStart:function(){},onImageLoadEnd:function(){},onStart:function(){},onEnd:function(){}},e.SimplBox=n}(window,document);